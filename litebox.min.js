/*!
    Litebox - dependency free lightboxes
    http://github.com/fitnr/litebox
    Copyright (C) 2015 Neil Freeman

    This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
    This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
    You should have received a copy of the GNU General Public License along with this program. If not, see <http://www.gnu.org/licenses/>.
*/
!function(e,t){typeof module!="undefined"?module.exports=t():typeof define=="function"&&typeof define.amd=="object"?define(t):this[e]=t()}("litebox",function(){function t(e){return function(t){t.key===27&&e.hide()}}function n(e,t,n){var r=this,i=function(t){return n.call(r,e,t)};e.addEventListener(t,i)}function r(e,n){var r={prefix:"litebox",maxWidth:Infinity,useTitle:!0};this.options=typeof n=="object"?n:{};for(var i in r)r.hasOwnProperty(i)&&!this.options.hasOwnProperty(i)&&(this.options[i]=r[i]);return this._wrapper=null,this._figure=null,this.escListener=t(this),e&&this.attach(e),this}var e=window.document;return r.prototype.sizeFigure=function(e){var t=e.width,n=e.height,r=this.options.maxWidth,i=this.figure();i.style.width=(t<r?t:r)+"px",i.style.height=(t<r?n:r/t*n)+"px"},r.prototype.wrapper=function(){return this._wrapper||this.create()},r.prototype.figure=function(){return this._figure||this.wrapper().getElementsByTagName("figure").item(0)},r.prototype.show=function(t,r){var i=this.wrapper(),s=this.figure(),o=i.getElementsByTagName("div").item(0),u=s.getElementsByTagName("figcaption").item(0);r.preventDefault(),s.style.display="none",i.style.display=o.style.display="block";var a=t.getAttribute("title"),f=this.options.useTitle?a:t.dataset.caption;f?(u.style.display="block",u.innerText=f):(u.style.display="none",u.innerText="");var l=e.createElement("img");n.call(this,l,"load",this.sizeFigure),n.call(this,l,"load",function(){s.style.display="block"}),s.insertBefore(l,u),l.src=t.href,e.addEventListener("keypress",this.escListener)},r.prototype.hide=function(){var t=this.figure();this.wrapper().style.display="none",t.removeChild(t.getElementsByTagName("img").item(0)),e.removeEventListener("keypress",this.escListener)},r.prototype.sizeWrapper=function(){var e=this.wrapper();e.style.width=window.innerWidth+"px",e.style.height=window.innerHeight+"px"},r.prototype.create=function(){this._wrapper=e.createElement("div"),this._wrapper.className=this.options.prefix+"-wrapper",this.sizeWrapper(),n.call(this,this._wrapper,"click",this.hide),n.call(this,window,"resize",this.sizeWrapper),e.body.insertBefore(this._wrapper,e.body.firstChild);var t=e.createElement("div");return t.className=this.options.prefix+"-loading",this._wrapper.appendChild(t),loader=e.createElement("div"),loader.innerText="Loading...",t.appendChild(loader),this._figure=e.createElement("figure"),this._wrapper.appendChild(figure),this._figure.appendChild(e.createElement("figcaption")),this._wrapper},r.prototype.attach=function(e){n.call(this,e,"click",this.show)},r})