!function(e,t){"undefined"!=typeof module?module.exports=t():"function"==typeof define&&"object"==typeof define.amd?define(t):this[e]=t()}("litebox",function(){function e(e){return function(t){27===t.key&&e.hide()}}function t(e,t,i){var r=this,s=function(t){return i.call(r,e,t)};e.addEventListener(t,s)}function i(t,i){var r={prefix:"litebox",maxWidth:1/0,useTitle:!0};this.options="object"==typeof i?i:{};for(var s in r)r.hasOwnProperty(s)&&!this.options.hasOwnProperty(s)&&(this.options[s]=r[s]);return this._wrapper=null,this._figure=null,this.escListener=e(this),t&&this.attach(t),this}var r=window.document;return i.prototype.sizeFigure=function(e){var t=e.width,i=e.height,r=this.options.maxWidth,s=this.figure();s.style.width=(r>t?t:r)+"px",s.style.height=(r>t?i:r/t*i)+"px"},i.prototype.wrapper=function(){return this._wrapper||this.create()},i.prototype.figure=function(){return this._figure||this.wrapper().getElementsByTagName("figure").item(0)},i.prototype.show=function(e,i){var s=this.wrapper(),n=this.figure(),p=s.getElementsByTagName("div").item(0),a=n.getElementsByTagName("figcaption").item(0);i.preventDefault(),n.style.display="none",s.style.display=p.style.display="block";var o=this.options.useTitle?e.title:e.dataset.caption;o?(a.style.display="block",a.innerHTML=o):(a.style.display="none",a.innerHTML="");var h=r.createElement("img");t.call(this,h,"load",this.sizeFigure),t.call(this,h,"load",function(){n.style.display="block"}),n.insertBefore(h,a),h.src=e.href||e.dataset.img,r.addEventListener("keypress",this.escListener)},i.prototype.hide=function(){var e=this.figure();this.wrapper().style.display="none",e.removeChild(e.getElementsByTagName("img").item(0)),r.removeEventListener("keypress",this.escListener)},i.prototype.sizeWrapper=function(){var e=this.wrapper();e.style.width=window.innerWidth+"px",e.style.height=window.innerHeight+"px"},i.prototype.create=function(){this._wrapper=r.createElement("div"),this._wrapper.className=this.options.prefix+"-wrapper",this.sizeWrapper(),t.call(this,this._wrapper,"click",this.hide),t.call(this,window,"resize",this.sizeWrapper),r.body.insertBefore(this._wrapper,r.body.firstChild);var e=r.createElement("div");return e.className=this.options.prefix+"-loading",this._wrapper.appendChild(e),loader=r.createElement("div"),loader.innerText="Loading...",e.appendChild(loader),this._figure=r.createElement("figure"),this._wrapper.appendChild(this._figure),this._figure.appendChild(r.createElement("figcaption")),this._wrapper},i.prototype.attach=function(e){t.call(this,e,"click",this.show)},i});